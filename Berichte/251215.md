# Vulnerability Scanning

## Optionen

Analysiere die Bedeutung der folgenden Optionen:

```
$ nmap -Pn -sS -sV -sC -oN nmap_default.txt 10.10.92.153
```

Was führt nmap in diesem Fall für einen Scan aus? Wie viele Ports werden gescannt. Scanne mit diesem Befehl die metasploitable VM


* Nmap führt einen TCP SYN Scan (-sS) ohne Ping durch (-Pn).
* Es werden die 1000 häufigsten TCP-Ports gescannt.
* Für offene Ports werden Dienste & Versionen erkannt (-sV).
* Zusätzlich laufen Standard-NSE-Skripte (-sC).
* Die Ausgabe wird in nmap_default.txt gespeichert.

## vulnerability scan

### Aufgabe 1

nmap verfügt über eine Erweiterung über die Lua Scripts ausgeführt werden können. Die installierten Lua Scripts befinden sich im Directory /usr/share/nmap/scripts.

Aufgabe 1: Verwende die Option -sC um die Standard-Skripte auszuführen, zusätzlich beschränkt auf die 100 häufigsten Ports (Option -F) aus.

Anmerkung: nmap kann wertvolle Hinweise auf Schwachstellen liefern, ein vollwertiger vulnerability scaner ist es allerdings nicht, dafür gibt es eigene darauf spezialisierte Tools (z.B.: gvm … Greenbone Vulnerability Manager).

### Ausgabe

```
Nmap scan report for 192.168.2.51
Host is up (0.0016s latency).
Not shown: 82 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 192.168.2.52
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
22/tcp   open  ssh
| ssh-hostkey: 
|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)
|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)
23/tcp   open  telnet
25/tcp   open  smtp
|_smtp-commands: metasploitable.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
|_ssl-date: 2025-12-15T11:05:02+00:00; +3s from scanner time.
| sslv2: 
|   SSLv2 supported
|   ciphers: 
|     SSL2_DES_192_EDE3_CBC_WITH_MD5
|     SSL2_RC4_128_WITH_MD5
|     SSL2_DES_64_CBC_WITH_MD5
|     SSL2_RC4_128_EXPORT40_WITH_MD5
|     SSL2_RC2_128_CBC_WITH_MD5
|_    SSL2_RC2_128_CBC_EXPORT40_WITH_MD5
53/tcp   open  domain
| dns-nsid: 
|_  bind.version: 9.4.2
80/tcp   open  http
|_http-title: Metasploitable2 - Linux
111/tcp  open  rpcbind
| rpcinfo: 
|   program version    port/proto  service
|   100000  2            111/tcp   rpcbind
|   100000  2            111/udp   rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/udp   nfs
|   100005  1,2,3      34854/udp   mountd
|   100005  1,2,3      41116/tcp   mountd
|   100021  1,3,4      46233/udp   nlockmgr
|   100021  1,3,4      56875/tcp   nlockmgr
|   100024  1          46005/udp   status
|_  100024  1          56667/tcp   status
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
513/tcp  open  login
514/tcp  open  shell
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
| mysql-info: 
|   Protocol: 10
|   Version: 5.0.51a-3ubuntu5
|   Thread ID: 17
|   Capabilities flags: 43564
|   Some Capabilities: Support41Auth, SupportsTransactions, ConnectWithDatabase, LongColumnFlag, SupportsCompression, SwitchToSSLAfterHandshake, Speaks41ProtocolNew
|   Status: Autocommit
|_  Salt: </u"G{Y+fBXrW=gr)pz7
5432/tcp open  postgresql
|_ssl-date: 2025-12-15T11:05:02+00:00; +3s from scanner time.
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
5900/tcp open  vnc
| vnc-info: 
|   Protocol version: 3.3
|   Security types: 
|_    VNC Authentication (2)
6000/tcp open  X11
8009/tcp open  ajp13
|_ajp-methods: Failed to get a valid response for the OPTION request
MAC Address: 00:0C:29:7E:F9:4D (VMware)

Host script results:
|_smb2-time: Protocol negotiation failed (SMB2)
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: metasploitable
|   NetBIOS computer name: 
|   Domain name: localdomain
|   FQDN: metasploitable.localdomain
|_  System time: 2025-12-15T06:04:34-05:00
|_clock-skew: mean: 1h15m03s, deviation: 2h30m00s, median: 2s
|_nbstat: NetBIOS name: METASPLOITABLE, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)

Nmap done: 1 IP address (1 host up) scanned in 43.38 seconds
```

### Aufgabe 2

Verwende die Option --script um ausgewählte Skripte zu starten. Z.B. --script http-title,mysql-info,banner. Probiere ca. 5 Skripte aus. Nimm die Metasploitable VM als Ziel.

```
$ nmap --script afp-ls,afp-brute,cics-info,dns-brute,dns-random-txid 192.168.2.51
```

### Ausgabe

```
Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-15 06:13 EST
Nmap scan report for 192.168.2.51
Host is up (0.00068s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address: 00:0C:29:7E:F9:4D (VMware)

Host script results:
|_dns-brute: Can't guess domain of "192.168.2.51"; use dns-brute.domain script argument.

Nmap done: 1 IP address (1 host up) scanned in 7.36 seconds

```

### Aufgabe 3

Finde ein weiteres Skript das bei der Metasploitable VM sinnvolle Ergebnisse liefert


**Nützliches Skript:** ftp-vsftpd-backdoor


### Ausgabe
```
Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-15 06:22 EST
Nmap scan report for 192.168.2.51
Host is up (0.0019s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
| ftp-vsftpd-backdoor: 
|   VULNERABLE:
|   vsFTPd version 2.3.4 backdoor
|     State: VULNERABLE (Exploitable)
|     IDs:  CVE:CVE-2011-2523  BID:48539
|       vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04.
|     Disclosure date: 2011-07-03
|     Exploit results:
|       Shell command: id
|       Results: uid=0(root) gid=0(root)
|     References:
|       http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523
|       https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb
|_      https://www.securityfocus.com/bid/48539
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address: 00:0C:29:7E:F9:4D (VMware)

Nmap done: 1 IP address (1 host up) scanned in 1.35 seconds
```

### Aufgabe 4

Aufgabe 4: Die nmap Skripte sind in Kategorien eingeteilt, es gibt z.B. eine Kategorie vuln (Siehe Kategorie vuln). Verwende die Option --script=vuln um alle Skripte dieser Kategorie zu starten. Verwende als Ziel die Metasploitable VM. Dieser Scan dauert sehr lange, schränke ein auf die Ports von FTP und HTTP.

### Lösung

Befehl:
```
$ nmap -Pn -p 21,80 --script=vuln 192.168.2.51
```

* -Pn → Host wird als „online“ angenommen, kein Ping nötig
* -p 21,80 → nur FTP (21) und HTTP (80) scannen → spart Zeit
* --script=vuln → führt alle Vulnerability-Skripte aus der Kategorie vuln aus

```
Nmap scan report for 192.168.2.51
Host is up (0.00065s latency).

PORT   STATE SERVICE
21/tcp open  ftp
| ftp-vsftpd-backdoor: 
|   VULNERABLE:
|   vsFTPd version 2.3.4 backdoor
|     State: VULNERABLE (Exploitable)
|     IDs:  BID:48539  CVE:CVE-2011-2523
|       vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04.
|     Disclosure date: 2011-07-03
|     Exploit results:
|       Shell command: id
|       Results: uid=0(root) gid=0(root)
|     References:
|       https://www.securityfocus.com/bid/48539
|       https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523
|_      http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html
80/tcp open  http
|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
|_http-trace: TRACE is enabled
| http-sql-injection: 
|   Possible sqli for queries:
|     http://192.168.2.51:80/dav/?C=N%3BO%3DD%27%20OR%20sqlspider
|     http://192.168.2.51:80/dav/?C=S%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.2.51:80/dav/?C=M%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.2.51:80/dav/?C=D%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=login.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=user-poll.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=secret-administrative-pages.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=documentation%2Fhow-to-access-Mutillidae-over-Virtual-Box-network.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/?page=user-info.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=site-footer-xss-discussion.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=source-viewer.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=captured-data.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=text-file-viewer.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=home.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=set-background-color.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/?page=credits.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/?page=source-viewer.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=browser-info.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=php-errors.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=usage-instructions.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=documentation%2Fvulnerabilities.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=register.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?do=toggle-security%27%20OR%20sqlspider&page=home.php
|     http://192.168.2.51:80/mutillidae/index.php?page=capture-data.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=pen-test-tool-lookup.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=change-log.htm%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=dns-lookup.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=framing.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=notes.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=password-generator.php%27%20OR%20sqlspider&username=anonymous
|     http://192.168.2.51:80/mutillidae/?page=text-file-viewer.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=arbitrary-file-inclusion.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=add-to-your-blog.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=view-someones-blog.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/?page=login.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/?page=add-to-your-blog.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=user-info.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=credits.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=show-log.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?do=toggle-hints%27%20OR%20sqlspider&page=home.php
|     http://192.168.2.51:80/mutillidae/index.php?page=installation.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=html5-storage.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/?page=view-someones-blog.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/?page=show-log.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/view/TWiki/TWikiHistory?rev=1.9%27%20OR%20sqlspider
|     http://192.168.2.51:80/rdiff/TWiki/TWikiHistory?rev2=1.8%27%20OR%20sqlspider&rev1=1.9
|     http://192.168.2.51:80/rdiff/TWiki/TWikiHistory?rev2=1.8&rev1=1.9%27%20OR%20sqlspider
|     http://192.168.2.51:80/oops/TWiki/TWikiHistory?param1=1.10%27%20OR%20sqlspider&template=oopsrev
|     http://192.168.2.51:80/oops/TWiki/TWikiHistory?param1=1.10&template=oopsrev%27%20OR%20sqlspider
|     http://192.168.2.51:80/rdiff/TWiki/TWikiHistory?rev2=1.9%27%20OR%20sqlspider&rev1=1.10
|     http://192.168.2.51:80/rdiff/TWiki/TWikiHistory?rev2=1.9&rev1=1.10%27%20OR%20sqlspider
|     http://192.168.2.51:80/view/TWiki/TWikiHistory?rev=1.8%27%20OR%20sqlspider
|     http://192.168.2.51:80/rdiff/TWiki/TWikiHistory?rev2=1.7%27%20OR%20sqlspider&rev1=1.8
|     http://192.168.2.51:80/rdiff/TWiki/TWikiHistory?rev2=1.7&rev1=1.8%27%20OR%20sqlspider
|     http://192.168.2.51:80/view/TWiki/TWikiHistory?rev=1.7%27%20OR%20sqlspider
|     http://192.168.2.51:80/view/TWiki/TWikiHistory?rev=1.9%27%20OR%20sqlspider
|     http://192.168.2.51:80/rdiff/TWiki/TWikiHistory?rev2=1.8%27%20OR%20sqlspider&rev1=1.9
|     http://192.168.2.51:80/rdiff/TWiki/TWikiHistory?rev2=1.8&rev1=1.9%27%20OR%20sqlspider
|     http://192.168.2.51:80/rdiff/TWiki/TWikiHistory?rev2=1.9%27%20OR%20sqlspider&rev1=1.10
|     http://192.168.2.51:80/rdiff/TWiki/TWikiHistory?rev2=1.9&rev1=1.10%27%20OR%20sqlspider
|     http://192.168.2.51:80/rdiff/TWiki/TWikiHistory?rev2=1.7%27%20OR%20sqlspider&rev1=1.8
|     http://192.168.2.51:80/rdiff/TWiki/TWikiHistory?rev2=1.7&rev1=1.8%27%20OR%20sqlspider
|     http://192.168.2.51:80/oops/TWiki/TWikiHistory?param1=1.10%27%20OR%20sqlspider&template=oopsrev
|     http://192.168.2.51:80/oops/TWiki/TWikiHistory?param1=1.10&template=oopsrev%27%20OR%20sqlspider
|     http://192.168.2.51:80/view/TWiki/TWikiHistory?rev=1.7%27%20OR%20sqlspider
|     http://192.168.2.51:80/view/TWiki/TWikiHistory?rev=1.8%27%20OR%20sqlspider
|     http://192.168.2.51:80/dav/?C=S%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.2.51:80/dav/?C=M%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.2.51:80/dav/?C=D%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.2.51:80/dav/?C=N%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.2.51:80/dav/?C=M%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.2.51:80/dav/?C=D%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.2.51:80/dav/?C=N%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.2.51:80/dav/?C=S%3BO%3DD%27%20OR%20sqlspider
|     http://192.168.2.51:80/dav/?C=S%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.2.51:80/dav/?C=M%3BO%3DD%27%20OR%20sqlspider
|     http://192.168.2.51:80/dav/?C=D%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.2.51:80/dav/?C=N%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.2.51:80/dav/?C=S%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.2.51:80/dav/?C=M%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.2.51:80/dav/?C=D%3BO%3DD%27%20OR%20sqlspider
|     http://192.168.2.51:80/dav/?C=N%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=login.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=user-poll.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=secret-administrative-pages.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=documentation%2Fhow-to-access-Mutillidae-over-Virtual-Box-network.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/?page=user-info.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=site-footer-xss-discussion.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=source-viewer.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=captured-data.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=text-file-viewer.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=home.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=set-background-color.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=browser-info.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/?page=credits.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/?page=register.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=documentation%2Fvulnerabilities.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=register.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=capture-data.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=pen-test-tool-lookup.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=change-log.htm%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=dns-lookup.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=framing.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/?page=source-viewer.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=password-generator.php%27%20OR%20sqlspider&username=anonymous
|     http://192.168.2.51:80/mutillidae/?page=text-file-viewer.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=arbitrary-file-inclusion.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=add-to-your-blog.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=view-someones-blog.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/?page=login.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=user-info.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=credits.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/?page=add-to-your-blog.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=show-log.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=installation.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/index.php?page=html5-storage.php%27%20OR%20sqlspider
|     http://192.168.2.51:80/mutillidae/?page=view-someones-blog.php%27%20OR%20sqlspider
|_    http://192.168.2.51:80/mutillidae/?page=show-log.php%27%20OR%20sqlspider
| http-fileupload-exploiter: 
|   
|_    Couldn't find a file-type field.
| http-csrf: 
| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.2.51
|   Found the following possible CSRF vulnerabilities: 
|     
|     Path: http://192.168.2.51:80/dvwa/
|     Form id: 
|     Form action: login.php
|     
|     Path: http://192.168.2.51:80/twiki/TWikiDocumentation.html
|     Form id: 
|     Form action: http://TWiki.org/cgi-bin/passwd/TWiki/WebHome
|     
|     Path: http://192.168.2.51:80/twiki/TWikiDocumentation.html
|     Form id: 
|     Form action: http://TWiki.org/cgi-bin/passwd/Main/WebHome
|     
|     Path: http://192.168.2.51:80/twiki/TWikiDocumentation.html
|     Form id: 
|     Form action: http://TWiki.org/cgi-bin/edit/TWiki/
|     
|     Path: http://192.168.2.51:80/twiki/TWikiDocumentation.html
|     Form id: 
|     Form action: http://TWiki.org/cgi-bin/view/TWiki/TWikiSkins
|     
|     Path: http://192.168.2.51:80/twiki/TWikiDocumentation.html
|     Form id: 
|     Form action: http://TWiki.org/cgi-bin/manage/TWiki/ManagingWebs
|     
|     Path: http://192.168.2.51:80/mutillidae/index.php?page=login.php
|     Form id: idloginform
|_    Form action: index.php?page=login.php
|_http-dombased-xss: Couldn't find any DOM based XSS.
| http-enum: 
|   /tikiwiki/: Tikiwiki
|   /test/: Test page
|   /phpinfo.php: Possible information file
|   /phpMyAdmin/: phpMyAdmin
|   /doc/: Potentially interesting directory w/ listing on 'apache/2.2.8 (ubuntu) dav/2'
|   /icons/: Potentially interesting folder w/ directory listing
|_  /index/: Potentially interesting folder
MAC Address: 00:0C:29:7E:F9:4D (VMware)

Nmap done: 1 IP address (1 host up) scanned in 320.35 seconds
```


## very safe FTP backdoor

Der vuln-scan auf Metasploitable Port 21/FTP liefert Hinweis auf eine Schwachstelle, verwende die angezeigte CVE Nummer um genaueres über diese herauszufinden.

### Lösung

CVE‑2011‑2523 (vsFTPd 2.3.4)
Betrifft den FTP‑Dienst vsFTPd 2.3.4 auf Port 21
Enthält eine eingebaute Backdoor
Login mit Benutzername :) öffnet eine Root‑Shell auf Port 6200
Ermöglicht Remote Code Execution
Kritische Schwachstelle (CVSS ~10)
Deshalb meldet der --script=vuln‑Scan diese CVE bei Metasploitable.
 

# Login Vulnerabilities

## rlogin vulnerability

rlogin (Port 513/TCP)
* Alter Remote-Login-Dienst, unsicher, keine Verschlüsselung
* Fehlkonfiguration: .rhosts oder /etc/hosts.equiv erlaubt root‑Login ohne Passwort
* Prüfen: nmap -p 513 -Pn 10.10.92.153 → Port offen bei Metasploitable
* Sicherheitslücke schließen:
1. rlogin deaktivieren/Service stoppen
2. .rhosts und hosts.equiv löschen
3. SSH stattdessen verwenden, Root-Login per SSH deaktivieren

### Befehl

```
$ nmap -Pn -p 513 192.168.2.51   
```
### Lösung

```
Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-15 06:52 EST
Nmap scan report for 192.168.2.51
Host is up (0.00064s latency).

PORT    STATE SERVICE
513/tcp open  login
MAC Address: 00:0C:29:7E:F9:4D (VMware)

Nmap done: 1 IP address (1 host up) scanned in 0.21 seconds

```

Befehl für Root-Login
```
$ rlogin -l root 192.168.2.51
```

#### Fehlkonfiguration
Die Fehlkonfiguration ist eine zu offene Vertrauenskonfiguration über
/root/.rhosts oder /etc/hosts.equiv, die passwortlosen Root‑Login per rlogin erlaubt.

#### Sicherheitslücke schließen

1. nano /etc/inetd.conf
2. login   stream  tcp  nowait  root  /usr/sbin/in.rlogind  in.rlogind mit # aiskommentieren
3. msf VM neu starten, dann geht rlogin nicht mehr

## Online password guessing

Machen wir nächstes Mal



